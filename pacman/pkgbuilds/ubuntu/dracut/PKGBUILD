# Maintainer: KZL <lz3450@outlook.com>

pkgname=dracut
pkgver=108
pkgrel=1
epoch=
pkgdesc="An event driven initramfs infrastructure"
arch=('x86_64')
url="https://github.com/dracut-ng/dracut-ng"
license=('KZL')
backup=(
  "$PREFIX/etc/dracut.conf"
)
source=(
  git+$url.git#tag=$pkgver
)
sha256sums=('3a719e83f1cb32f1c49135c92cb831f20da0dab05b101c834c1856ae3b3b3081')

# pkgver() {
#   cd dracut-ng
#
#   git describe --tags | sed 's/-g.*//;s/-/.g/'
# }

build() {
  cd dracut-ng

  msg2 "Configuring..."
  ./configure \
    --prefix=/usr \
    --disable-documentation

  msg2 "Compiling..."
  make
}

package() {
  cd dracut-ng

  make DESTDIR="$pkgdir" install

  install -dm755 "$pkgdir"/etc/dracut.conf.d
}
