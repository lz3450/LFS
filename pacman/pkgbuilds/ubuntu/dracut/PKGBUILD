# Maintainer: KZL <lz3450@outlook.com>

pkgname=dracut
pkgver=110
pkgrel=4
epoch=
pkgdesc="An event driven initramfs infrastructure"
arch=('x86_64')
url="https://github.com/dracut-ng/dracut-ng"
license=('KZL')
backup=(
  "$PREFIX/etc/dracut.conf"
)
install=$pkgname.install
source=(
  git+$url.git#tag=$pkgver
)
sha256sums=('6936901db728a5b9dec2a11f389d7b2a5c9f35e00dfd6be8ee5e6d7135febc99')

# pkgver() {
#   cd dracut-ng
#
#   git describe --tags | sed 's/-g.*//;s/-/.g/'
# }

build() {
  cd dracut-ng

  msg2 "Configuring..."
  ./configure \
    --prefix=/usr \
    --disable-documentation

  msg2 "Compiling..."
  make
}

package() {
  cd dracut-ng

  make DESTDIR="$pkgdir" install

  install -dm755 "$pkgdir"/etc/dracut.conf.d
}
